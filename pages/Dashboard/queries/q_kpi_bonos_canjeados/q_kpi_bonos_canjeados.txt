SELECT
  COUNT(*)::int AS bonos_canjeados
FROM "Reward" r
JOIN "Customer" c ON c.id = r."customerId"
WHERE r.status = 'REDEEMED'
  AND r."redeemedAt"::date BETWEEN {{ Filters.fromISO() }}::date AND {{ Filters.toISO() }}::date
  AND (
    {{ Auth.businessId() ? 1 : 0 }} = 0
    OR c."businessId" = {{ Auth.businessId() }}::uuid
  );
