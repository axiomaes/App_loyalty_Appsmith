-- Verifica que la contraseña actual sea correcta
-- Usa el user_id de sesión (o el email) y el businessId para aislar por tenant.

SELECT 1
FROM "User"
WHERE id = {{ appsmith.store.userId }}::uuid
  AND "businessId" = {{ Auth.businessId() }}::uuid
  AND password = crypt({{ this.params.currentPassword }}, password)
LIMIT 1;
